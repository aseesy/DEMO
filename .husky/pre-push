#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸ” Running pre-push checks..."

# Run tests for backend
if [ -d "chat-server" ]; then
  echo "ğŸ“¦ Running backend tests..."
  cd chat-server
  npm test -- --passWithNoTests || {
    echo "âŒ Backend tests failed. Please fix before pushing."
    exit 1
  }
  cd ..
fi

# Run tests for frontend
if [ -d "chat-client-vite" ]; then
  echo "ğŸ“¦ Running frontend tests..."
  cd chat-client-vite
  npm test -- --run || {
    echo "âŒ Frontend tests failed. Please fix before pushing."
    exit 1
  }
  cd ..
fi

echo "âœ… All pre-push checks passed!"
