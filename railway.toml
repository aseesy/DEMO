# Railway Configuration
# PostgreSQL-only production setup
# Frontend is deployed separately on Vercel
#
# DEPLOYMENT SETUP (as of 2025-12-15):
# - Deploy from ROOT directory (/chat/)
# - Root nixpacks.toml handles: cd chat-server && npm install && node server.js
# - NO root_dir setting needed in Railway dashboard
# - pnpm files excluded via .railwayignore

[build]
builder = "nixpacks"
watchPatterns = ["chat-server/**"]
buildCommand = "cd chat-server && rm -rf node_modules && npm install --legacy-peer-deps && echo 'Build v1.0.3 with neo4j-driver complete'"

[deploy]
startCommand = "cd chat-server && node server.js"
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 10
healthcheckPath = "/health"
healthcheckTimeout = 300

# REQUIRED ENVIRONMENT VARIABLES:
# - DATABASE_URL: PostgreSQL connection string (auto-set if using Railway Postgres)
# - JWT_SECRET: For authentication
# - OPENAI_API_KEY: For AI mediation features
# - GMAIL_*: For email notifications
#
# OPTIONAL:
# - NEO4J_URI, NEO4J_PASSWORD: For graph database (set to external URL, not localhost)
